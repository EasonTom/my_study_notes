# 安装软件的问题

deepin虽然有自己的商城，但是安装软件大多数还是要下载安装包然后自己编译。但是安装软件会依赖于其他软件包。

使用dpkg安装deb包出现依赖的问题：

首先将软件安装的源换掉：

打开源列表文件：

    sudo vim /etc/apt/sources.list

将里面的内容换掉，注意换之前最好备份一下：

    # Generated by deepin-installer
    deb [by-hash=force] http://mirrors.aliyun.com/deepin panda main contrib non-free
    deb-src http://mirrors.aliyun.com/deepin panda main contrib non-free

然后更新一下源：

    sudo apt-get update

无报错说明换源成功

但是在换阿里或者其他源的时候会出现错误。

阿里源：

```
# 默认注释了源码镜像以提高 apt update 速度，如有需要可自行取消注释
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial main restricted universe multiverse
# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial main restricted universe multiverse
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial-updates main restricted universe multiverse
# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial-updates main restricted universe multiverse
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial-backports main restricted universe multiverse
# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial-backports main restricted universe multiverse
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial-security main restricted universe multiverse
# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial-security main restricted universe multiverse

# 预发布软件源，不建议启用
# deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial-proposed main restricted universe multiverse
# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial-proposed main restricted universe multiverse
```
在更新的时候报错：
```
由于没有公钥，无法验证下列签名： NO_PUBKEY E40EBBA24FF2FC69
```

网上查找解决方案：

    sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys E40EBBA24FF2FC69  # 解决方法中的 E40EBBA24FF2FC69要与你提示错误中的签名（如下）一致。

但是又会报错：

```
sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys E084DAB9
Executing: /tmp/tmp.zHjcipDG21/gpg.1.sh --keyserver keyserver.ubuntu.com --recv-keys E084DAB9
gpg: failed to start the dirmngr '/usr/bin/dirmngr': 没有那个文件或目录
gpg: connecting dirmngr at '/tmp/tmp.zHjcipDG21/S.dirmngr' failed: 没有那个文件或目录
gpg: keyserver receive failed: No dirmngr

```

需要安装dirmngr的包：

    sudo apt install dirmngr

装包的时候又会遇到一些依赖问题，此时安装流程现将源换成可以用的，然后更新，然后强制解决依赖冲突等等操作。

    sudo apt-get -f -y install
    sudo apt --fix-broken install

然后再安装dirmngr，按照步骤完成源的更新

然后再使用`dpkg -i`再次安装软件包，还是出现依赖问题，此时运行如下命令：

    sudo apt-get -f -y install

然后再dpkg安装软件。

安装完软件后可以建立一个软链接。

# deepin安装redis-desktop-manager

安装常规软件可以使用上面的方法（如securecrt），但是安装edis-desktop-manager仍然会出现问题。

首先下载 RedisDesktopManager 的deb包，由于是以https开头的域名，为避免报错，添加 no-check-certificate 不检查证书

    wget https://github.com/uglide/RedisDesktopManager/releases/download/0.8.3/redis-desktop-manager_0.8.3-120_amd64.deb --no-check-certificate

或者去[官网](https://github.com/uglide/RedisDesktopManager/releases)下载这里下载的是0.8.3版本

然后使用dpkg安装时出现问题，提示缺少依赖，需要安装zlibc、libicu52

所以需要手动安装（不知道为什么这个不能自动补全依赖）

    sudo apt-get install zlib1g-dev
    sudo apt-get -f install libicu52

或者apt源下载较慢，使用wget下载然后dpkg安装

    wget http://security.ubuntu.com/ubuntu/pool/main/i/icu/libicu52_52.1-3_amd64.deb

然后安装redis-desktop-manager
    
    sudo apt-get -f install
    
    sudo dpkg -i redis-desktop-manager_0.8.3-120_amd64.deb

# deepin安装redis-desktop-manager新问题

使用上述方法安装完成后无法使用ssh通道（部分redis库需要通过跳板机连接），在redis的[官方文档](http://docs.redisdesktop.com/en/latest/install/#ubuntu-archlinux-debian-fedora-centos-opensuse-etc)找到了新的安装方法：

直接使用snap安装：

    sudo snap install redis-desktop-manager

但是在这之前需要安装snap

    $ sudo apt update
    $ sudo apt install snapd

官方文档提示0.9.9版本之后rdm好像默认不支持ssh了，需要手动打开（不知道之前的那个版本能不能通过这种方法打开ssh通道，没试过被我卸载重装了）

    To be able to access your ssh keys from RDM please connect ssh-key interface: 
    
    sudo snap connect redis-desktop-manager:ssh-keys



# 能ping通网络但是浏览器不能上网的问题

因为需要，安装了wireshark的抓包工具，安装完成后发现谷歌浏览器连接不上网络了，但是在终端中能ping通网络，同一个网址wget又被拒绝：

    正在连接 127.0.0.1:38495... 失败：拒绝连接。

从报错看出系统在连接一个代理的时候被拒绝，表示wireshake在安装的时候设置了系统代理，通过上网查到解决办法，在linux的系统设置中找到系统代理，将自动改成无就可以上网了。

# 安装mysql问题

## 问题

deepin安装mysql很简单，直接使用apt-get工具下载：

```
sudo apt-get install mysql-server
```

这样安装的好处是很多配置都是自动的，包括配置开机启动等等。

但是问题是安装完成后无法登录到mysql中，提示：

```
ERROR 1698 (28000): Access denied for user 'root'@'localhost'
```

因为安装的过程中没让设置密码，可能密码为空，但无论如何都进不去mysql。

## 解决办法

1. 在终端中输入`sudo vim /etc/mysql/mysql.conf.d/mysqld.cnf`,进入到这个配置文件，然后在这个配置文件中的`[mysqld]`这一块中加入`skip-grant-tables`这句话，作用就是让你可以不用密码登录进mysql。

```
 1 [mysqld]
 2 #
 3 # * Basic Settings
 4 #
 5 user            　 = mysql
 6 pid-file        　 = /var/run/mysqld/mysqld.pid
 7 socket        　　 = /var/run/mysqld/mysqld.sock
 8 port            　 = 3306
 9 basedir        　　= /usr
10 datadir       　　 = /var/lib/mysql
11 tmpdir       　　　= /tmp
12 lc-messages-dir   = /usr/share/mysql
13 skip-external-locking
14 character-set-server=utf8
15 collation-server=utf8_general_ci
16 skip-grant-tables　　　　<-- add here
```

添加完成后保存退出，然后重启mysql服务：

```
service mysql restart
```

2. 终端输入`mysql -u root -p`，遇见输入密码的提示直接回车即可
3. 进入mysql后执行下面命令：

```
use mysql  # 选择数据库
select user,plugin from user;  # 查看用户
```

![img](https://img2018.cnblogs.com/blog/1425775/201809/1425775-20180904131927504-1825749614.png)

此时root用户的plugin字段是auth_socket，那我们改掉它为下面的mysql_native_password并同时设置密码；

如果安装5.7并且没有为root用户提供密码，它将使用auth_socket插件。该插件不关心，也不需要密码。它只检查用户是否使用UNIX套接字进行连接，然后比较用户名。如果我们要配置密码，我们需要在同一命令中同时更改插件并设置密码。首先更改插件然后设置密码将不起作用，它将再次回退到auth_socket。

```
ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY 'password';  # password 要修改的密码
```

修改后查看，修改成功：

```
select user,plugin from user;
```

![img](https://img2018.cnblogs.com/blog/1425775/201809/1425775-20180904132726355-2128351537.png)

然后刷新权限表（或者重启mysql服务来使配置生效）：

```
flush privileges;
```

退出mysql。

4. 将第1步加入的那行注释掉，重启服务，然后就可以使用密码登录了。